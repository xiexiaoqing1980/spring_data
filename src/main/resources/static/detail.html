<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script type="text/javascript" src="/js/jquery-1.12.4.min.js"></script>
<!--<script type="text/javascript" src="/js/bootstrap.min.js"></script>-->
<body>
<div class="index-container">
    <div class="topic-flow-container">
        <div class="group-list-container">
            <div class="group-list-wrapper"></div>
        </div>

        <div class="main-content-container">
            <!--<div class="post-container"></div>-->
            <div class="topic-filter-container">
                <div class="filter-container">过滤器</div>
                <!--<div class="select-icon"></div>-->
            </div>

            <div class="sticky-topic-container">置顶帖</div>

            <div class="topics-container">
            </div>

            <div class="next-page">
                下一页
            </div>

        </div>

        <div class="group-preview-container">
            <div class="group-preview-wrapper">
            </div>
        </div>

        <div class="go-top" id="js-gotop">返回顶部</div>
    </div>
</div>



</body>
<script>
    $(document).ready(function() {
    var id=getQueryVariable(id);
        $.ajax({
<!--            url: "http://127.0.0.1:8081/zsxq/yecheng",-->
                url: "http://127.0.0.1:8081/zsxq/yecheng"+"?id="+id,
<!--            url: "http://120.24.90.17:8088/zsxq/query/origin/detail?id=824511824552",-->
            dataType: "json",//数据格式
            type: "get",//请求方式
            async: true,//是否异步请求
            // error: erryFunction, //错误执行方法
            success: function (data) {   //如果请求成功，返回数据。
                var html = "";
                var model = data.model;   //获取model数组
                $.each(model, function (index1, item) {
                    var comment='';

                    $.each(item.show_comments,function (index,value) {
                        comment+= '<div class="comment-item-container"><div class="comment-item"><span class="comment-owner">' +
                            value.owner.name + '</span><span>' + value.text + '</span>'
                            + '</div><div class="comment-time">' + convertTime(value.create_time) + '</div></div>';

                    })
                    html += '<div class="topic-container"><div class="topic-header-container">' +
                        '<div class="author"><div class="info"><div class="role-owner">' + item.talk.owner.name + ' </div>' +
                        '<div class="date">' + convertTime(item.create_time) + '</div></div></div></div>' + '<div class="talk-content-container"><div class="content">' + item.talk.text + '</div></div> <div class="comment-box">'+comment+'</div></div>'


                    // $('.topics-container').append(html)
                });
                $('.topics-container').html(html);
                function convertTime(timestamp) {
                    var date = new Date(timestamp); //时间戳为10位需*1000，时间戳为13位的话不需乘1000
                    Y = date.getFullYear() + '-';
                    M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
                    D = change(date.getDate()) + ' ';
                    h = change(date.getHours()) + ':';
                    m = change(date.getMinutes()) + ':';
                    s = change(date.getSeconds());
                    return Y + M + D + h + m + s;

                }

                function change(t) {
                    if (t < 10) {
                        return "0" + t;
                    } else {
                        return t;
                    }

//
                }
            }
        })
    })

    function  getQueryVariable(variable){

	var str =location.search.length >0 ? location.search.substring(1):"";
	var vars =str.split("&");
	for(i in vars){
		 var item=i.split("=");
		if(item[0]== variable){
			return item[1];
	 }
     }
    }

// <!-- alert(1)-->
</script>
</html>